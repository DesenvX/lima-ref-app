import{r as w,B as J,u as K,E as Q,d as l,G as W,o as n,e as A,f as t,g as e,w as r,F as B,l as k,x as C,i as u,T as X,j as Y,k as Z,n as f,J as ee,q as v,t as se}from"./index-b8b7d0fa.js";import{h as E,a as T}from"./messages-c18080ba.js";const oe={class:"card"},ae=e("h5",null,"USUÁRIOS",-1),te={class:"my-2"},le={class:"grid p-fluid mt-1"},re={class:"field col-12 md:col-6"},ie={class:"p-float-label"},ne=e("label",{for:"addUsername"},[e("span",{style:{color:"red"}},"*"),v(" Nome de Usuário ")],-1),de={class:"field col-12 md:col-6"},ce={class:"p-float-label"},ue=e("label",{for:"addEmail"},[e("span",{style:{color:"red"}},"*"),v(" Email ")],-1),me={class:"field col-12 md:col-6"},pe={class:"p-float-label"},_e=e("label",{for:"addPassword"},[e("span",{style:{color:"red"}},"*"),v(" Senha ")],-1),fe={class:"field col-12 md:col-6"},ve={class:"p-float-label"},ye=e("label",{for:"addConfirmPassword"},[e("span",{style:{color:"red"}},"*"),v(" Confirmar Senha ")],-1),be={class:"field col-12 md:col-6"},ge={class:"p-float-label"},we={class:"field col-12 md:col-6"},he={class:"p-float-label"},Ue=e("label",{for:"addAdmin",style:{"margin-left":"20px"}}," Administrador",-1),ke=e("i",{class:"pi pi-check mt-1"},null,-1),Ce=e("i",{class:"pi pi-times mt-1"},null,-1),xe=e("i",{class:"pi pi-check mt-1"},null,-1),Pe=e("i",{class:"pi pi-times mt-1"},null,-1),Ee={__name:"Users",setup(Ve){const D=w(null),M=J(),d=K(),o=w([]),x=w([]),h=async()=>{k();try{const i=await C.get("/users");x.value=i.data,u()}catch(i){d.add({severity:"error",summary:"Erro",detail:"Erro ao buscar serviços do depósito",life:5e3}),u(),console.error(i)}},S=async i=>{k();try{await C.delete("/users/"+i),d.add({severity:"success",summary:"Deletado",detail:"Usuário deletado com sucesso",life:5e3}),await h(),u()}catch(s){d.add({severity:"error",summary:"Erro",detail:s.response.data.msg,life:5e3}),console.error(s),u()}},L=(i,s)=>{M.require({target:i.target,message:"Deseja realmente excluir este usuário?",icon:"pi pi-exclamation-triangle",acceptLabel:"Sim",rejectLabel:"Não",accept:()=>{S(s)}})},N=async i=>{const s=i.files[0],p=new FileReader;let y=await fetch(s.objectURL).then(c=>c.blob());const U=40*1024;y.size>U?d.add({severity:"error",summary:"Erro",detail:"Imagem muito grande. Max: 30KB. Para redimencionar sua imagem acesse: https://www.shutterstock.com/pt/image-resizer ",life:8e3}):(p.readAsDataURL(y),p.onloadend=function(){const c=p.result;o.value.signature=c})},F=async()=>{k();try{await C.post("/users",{username:o.value.username,email:o.value.email,password:o.value.password,confirmPassword:o.value.confirmPassword,signature:o.value.signature,admin:o.value.admin}),d.add({severity:"success",summary:"Adicionado",detail:"Usuário adicionado com sucesso",life:5e3}),await h(),P(),u()}catch(i){d.add({severity:"error",summary:"Erro",detail:"Erro ao adicionar usuário",life:5e3}),console.error(i),u()}},I=async()=>{!o.value.username||!o.value.email||!o.value.password||!o.value.confirmPassword?T("addUser","error","Preencha todos os campos obrigatórios."):o.value.password!==o.value.confirmPassword?T("addUser","error","Senhas incoerentes."):await F()},m=w(!1),j=()=>{E.value.length=0,m.value=!0},P=()=>{m.value==!0&&(m.value=!1,o.value=[])};return Q(()=>{h()}),(i,s)=>{const p=l("ConfirmPopup"),y=l("Toast"),U=l("Message"),c=l("InputText"),V=l("Password"),G=l("FileUpload"),R=l("Checkbox"),b=l("Button"),z=l("Dialog"),$=l("Toolbar"),_=l("Column"),g=l("Badge"),q=l("DataTable"),O=W("tooltip");return n(),A(B,null,[t(p),t(y),e("div",oe,[ae,t($,{class:"mb-4"},{start:r(()=>[e("div",te,[t(z,{header:"Adicionar Usuário",visible:m.value,"onUpdate:visible":s[7]||(s[7]=a=>m.value=a),position:"top",breakpoints:{"960px":"75vw"},style:{width:"28vw"},modal:!0},{footer:r(()=>[t(b,{label:"Cancelar",icon:"pi pi-times",class:"p-button-danger",onClick:s[5]||(s[5]=a=>P())}),t(b,{label:"Adicionar",icon:"pi pi-check",class:"p-button-success",onClick:s[6]||(s[6]=a=>I())})]),default:r(()=>[t(X,{tag:"div"},{default:r(()=>[(n(!0),A(B,null,Y(Z(E),a=>(n(),f(U,{severity:a.severity,key:a.content},{default:r(()=>[v(se(a.content),1)]),_:2},1032,["severity"]))),128))]),_:1}),e("div",le,[e("div",re,[e("span",ie,[t(c,{type:"text",id:"addUsername",modelValue:o.value.username,"onUpdate:modelValue":s[0]||(s[0]=a=>o.value.username=a)},null,8,["modelValue"]),ne])]),e("div",de,[e("span",ce,[t(c,{type:"text",id:"addEmail",modelValue:o.value.email,"onUpdate:modelValue":s[1]||(s[1]=a=>o.value.email=a)},null,8,["modelValue"]),ue])]),e("div",me,[e("span",pe,[t(V,{id:"addPassword",modelValue:o.value.password,"onUpdate:modelValue":s[2]||(s[2]=a=>o.value.password=a),toggleMask:"",feedback:!1},null,8,["modelValue"]),_e])]),e("div",fe,[e("span",ve,[t(V,{id:"addConfirmPassword",modelValue:o.value.confirmPassword,"onUpdate:modelValue":s[3]||(s[3]=a=>o.value.confirmPassword=a),toggleMask:"",feedback:!1},null,8,["modelValue"]),ye])]),e("div",be,[e("span",ge,[t(G,{id:"addSignature",mode:"basic",url:"/api/upload",accept:"image/*",customUpload:"",onUploader:N,chooseLabel:"Assinatura"})])]),e("div",we,[e("span",he,[t(R,{id:"addAdmin",modelValue:o.value.admin,"onUpdate:modelValue":s[4]||(s[4]=a=>o.value.admin=a),binary:!0},null,8,["modelValue"]),Ue])])])]),_:1},8,["visible"]),t(b,{label:"Adicionar",icon:"pi pi-plus",class:"p-button-primary mr-2",onClick:s[8]||(s[8]=a=>j())})])]),_:1}),t(q,{value:x.value,rowHover:!0,showGridlines:"",tableStyle:"min-width: 50rem"},{default:r(()=>[t(_,{bodyClass:"text-center",field:"username",header:"Nome de Usuário"}),t(_,{bodyClass:"text-center",field:"email",header:"Email"}),t(_,{bodyClass:"text-center",field:"admin",header:"Administrador"},{body:r(({data:a})=>[a.admin?(n(),f(g,{key:0,severity:"success"},{default:r(()=>[ke]),_:1})):(n(),f(g,{key:1,severity:"warning"},{default:r(()=>[Ce]),_:1}))]),_:1}),t(_,{bodyClass:"text-center",field:"signature",header:"Assinatura"},{body:r(({data:a})=>[a.signature?(n(),f(g,{key:0,severity:"success"},{default:r(()=>[xe]),_:1})):(n(),f(g,{key:1,severity:"warning"},{default:r(()=>[Pe]),_:1}))]),_:1}),t(_,{bodyClass:"text-center"},{body:r(({data:a})=>[ee(t(b,{ref_key:"popup",ref:D,onClick:H=>L(H,a.id),icon:"pi pi-trash",class:"p-button-rounded p-button-danger"},null,8,["onClick"]),[[O,"Excluir",void 0,{top:!0}]])]),_:1})]),_:1},8,["value"])])],64)}}};export{Ee as default};

import{u as C,y as I,r as y,z as $,d as l,o as T,e as A,f as o,w as d,g as a,k as S,A as G,F as k,q as m,l as E,x as w,i as u,S as L,B as O,D as U,E as j,G as M,t as V,L as R,J as q}from"./index-b8b7d0fa.js";const z={class:"grid p-fluid mt-1"},H={class:"field col-12 md:col-12"},J={class:"p-float-label block"},K=a("label",{for:"date"},[a("span",{style:{color:"red"}},"*"),m(" Data")],-1),Q={class:"field col-12 md:col-12"},W={class:"p-float-label"},X=a("label",{for:"type"},[a("span",{style:{color:"red"}},"*"),m(" Tipo")],-1),Y={class:"field col-12 md:col-12"},Z={class:"p-float-label"},ee=a("label",{for:"description"},[a("span",{style:{color:"red"}},"*"),m(" Descrição")],-1),oe={class:"field col-12 md:col-12"},ae={class:"p-float-label"},te=a("label",{for:"value"},[a("span",{style:{color:"red"}},"*"),m(" Valor")],-1),se={__name:"DialogAddExpenses",setup(B){const v=C(),r=I("visibleDialogAdd"),e=y({}),b=y([{name:"Peça",code:"P"},{name:"Salário",code:"S"},{name:"Aluguel",code:"A"},{name:"Gasolina",code:"G"},{name:"Veículo",code:"V"},{name:"Feramenta",code:"F"},{name:"Pessoal",code:"PS"},{name:"Emergência",code:"E"},{name:"Outro",code:"O"}]),_=()=>{e.value.date&&e.value.type&&e.value.description&&e.value.value?(r.value=!1,console.log(e),g()):v.add({severity:"error",summary:"Erro",detail:"Todos os campos são obrigatórios.",life:8e3})},g=async()=>{E();try{const c=await w.post("/expenses",{date:e.value.date,type:e.value.type.name,description:e.value.description,value:e.value.value});console.log(c.data),u(),v.add({severity:"success",summary:"Adicionado",detail:"Despesa cadastrada com sucesso!",life:8e3}),e.value={}}catch{u(),v.add({severity:"error",summary:"Erro",detail:"Erro ao tentar cadastrar despesa.",life:8e3})}};return $(()=>{const c=new Date().toISOString().slice(0,10);e.value.date=c}),(c,s)=>{const n=l("Toast"),i=l("InputText"),D=l("Dropdown"),x=l("InputNumber"),f=l("Button"),h=l("Dialog");return T(),A(k,null,[o(n),o(h,{visible:S(r),"onUpdate:visible":s[6]||(s[6]=t=>G(r)?r.value=t:null),header:"Cadastrar Despesas",style:{width:"25rem"},breakpoints:{"1199px":"75vw","575px":"90vw"},position:"top",modal:!0,draggable:!1},{footer:d(()=>[o(f,{label:"Cancelar",icon:"pi pi-times",class:"p-button-danger",onClick:s[4]||(s[4]=t=>r.value=!1)}),o(f,{label:"Cadastrar",icon:"pi pi-check",class:"p-button-success",autofocus:"",onClick:s[5]||(s[5]=t=>_())})]),default:d(()=>[a("div",z,[a("div",H,[a("span",J,[o(i,{type:"date",modelValue:e.value.date,"onUpdate:modelValue":s[0]||(s[0]=t=>e.value.date=t),id:"date"},null,8,["modelValue"]),K])]),a("div",Q,[a("div",W,[o(D,{modelValue:e.value.type,"onUpdate:modelValue":s[1]||(s[1]=t=>e.value.type=t),inputId:"type",options:b.value,optionLabel:"name"},null,8,["modelValue","options"]),X])]),a("div",Y,[a("span",Z,[o(i,{id:"description",modelValue:e.value.description,"onUpdate:modelValue":s[2]||(s[2]=t=>e.value.description=t)},null,8,["modelValue"]),ee])]),a("div",oe,[a("span",ae,[o(x,{id:"value",modelValue:e.value.value,"onUpdate:modelValue":s[3]||(s[3]=t=>e.value.value=t)},null,8,["modelValue"]),te])])])]),_:1},8,["visible"])],64)}}},le={class:"card"},ne=a("h5",null,"DESPESAS",-1),de={__name:"Manager",setup(B){const v=L("http://localhost:3333"),r=O(),e=C(),b=y(!1);U("visibleDialogAdd",b);const _=y([]);v.on("reloadDataExpenses",n=>{_.value=n});const g=async()=>{E();try{const n=await w.get("/expenses");_.value=n.data,u()}catch{u(),e.add({severity:"error",summary:"Erro",detail:"Não foi possível buscar despesas.",life:8e3})}};j(()=>{g()});const c=async n=>{E();try{await w.delete("/expenses/"+n),u(),e.add({severity:"success",summary:"Sucesso",detail:"Despesa deletada com sucesso!",life:8e3})}catch{u(),e.add({severity:"error",summary:"Erro",detail:"Não foi possível deletar despesa.",life:8e3})}},s=(n,i)=>{r.require({target:n.currentTarget,message:"Deseja realmente excluir esta despesa?",icon:"pi pi-exclamation-triangle",acceptLabel:"Sim",rejectLabel:"Não",accept:()=>{c(i.id)}})};return(n,i)=>{const D=l("Toast"),x=l("ConfirmPopup"),f=l("Button"),h=l("Toolbar"),t=l("Column"),P=l("DataTable"),N=M("tooltip");return T(),A(k,null,[o(D),o(x),a("div",le,[ne,o(h,{class:"mb-4"},{start:d(()=>[o(f,{label:"Cadastrar",icon:"pi pi-sign-out",severity:"warning",iconPos:"left",onClick:i[0]||(i[0]=p=>b.value=!0)}),o(se)]),end:d(()=>[]),_:1}),o(P,{value:_.value,rowHover:!0,paginator:"",showGridlines:"",rows:10,rowsPerPageOptions:[5,10,20,50],tableStyle:"min-width: 50rem"},{default:d(()=>[o(t,{field:"id",header:"#"}),o(t,{field:"date",sortable:"",header:"Data"},{body:d(({data:p})=>[m(V(S(R)(p.date)),1)]),_:1}),o(t,{field:"type",header:"Tipo"}),o(t,{field:"description",header:"Descrição",style:{width:"30%"}}),o(t,{field:"value",header:"Valor"},{body:d(({data:p})=>[m(" R$ "+V(parseFloat(p.value).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})),1)]),_:1}),o(t,{style:{width:"5%"}},{body:d(({data:p})=>[q(o(f,{onClick:F=>s(F,p),icon:"pi pi-trash",class:"ml-1 p-button-rounded p-button-danger"},null,8,["onClick"]),[[N,"Excluir",void 0,{top:!0}]])]),_:1})]),_:1},8,["value"])])],64)}}};export{de as default};
